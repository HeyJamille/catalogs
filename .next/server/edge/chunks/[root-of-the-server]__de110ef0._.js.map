{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["// middleware.ts\nimport { NextResponse } from \"next/server\";\nimport type { NextRequest } from \"next/server\";\n\nimport { RegraUsuario, podeAcessarRota } from \"./utils/authRules\"; // ajuste o caminho\n\nexport function middleware(request: NextRequest) {\n  const token = request.cookies.get(\"auth_token\")?.value;\n  const userRule = request.cookies.get(\"user_rule\")?.value as\n    | RegraUsuario\n    | undefined;\n\n  const pathname = request.nextUrl.pathname;\n\n  // Rotas que precisam de proteção\n  const rotasProtegidas = [\"/dashboard\", \"/catalogo\", \"/dono\"];\n\n  const isProtectedRoute = rotasProtegidas.some((rota) =>\n    pathname.startsWith(rota)\n  );\n\n  if (!token || !userRule) {\n    if (isProtectedRoute) {\n      // Se não tem token ou regra e está tentando acessar rota protegida, redireciona pro login\n      return NextResponse.redirect(new URL(\"/signin\", request.url));\n    }\n    return NextResponse.next();\n  }\n\n  // Verifica se o usuário pode acessar a rota\n  if (isProtectedRoute && !podeAcessarRota(userRule, pathname)) {\n    // Redireciona para página de acesso negado, pode ser uma página customizada ou login\n    return NextResponse.redirect(new URL(\"/forbidden\", request.url));\n  }\n\n  return NextResponse.next();\n}\n\nexport const config = {\n  matcher: [\"/dashboard/:path*\", \"/catalogo/:path*\", \"/dono/:path*\"],\n};\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;AAChB;AAAA;;;;;;;;AAKO,SAAS,WAAW,OAAoB;IAC7C,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;IACjD,MAAM,WAAW,QAAQ,OAAO,CAAC,GAAG,CAAC,cAAc;IAInD,MAAM,WAAW,QAAQ,OAAO,CAAC,QAAQ;IAEzC,iCAAiC;IACjC,MAAM,kBAAkB;QAAC;QAAc;QAAa;KAAQ;IAE5D,MAAM,mBAAmB,gBAAgB,IAAI,CAAC,CAAC,OAC7C,SAAS,UAAU,CAAC;IAGtB,IAAI,CAAC,SAAS,CAAC,UAAU;QACvB,IAAI,kBAAkB;YACpB,0FAA0F;YAC1F,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,WAAW,QAAQ,GAAG;QAC7D;QACA,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC1B;IAEA,4CAA4C;IAC5C,IAAI,oBAAoB,CAAC,gBAAgB,UAAU,WAAW;QAC5D,qFAAqF;QACrF,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,cAAc,QAAQ,GAAG;IAChE;IAEA,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAqB;QAAoB;KAAe;AACpE"}}]
}