{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/jamille/Documentos/catalogs/utils/api/fetchData.ts"],"sourcesContent":["// Biblioteca\nimport axios from \"axios\";\n\nexport function setupApiClient(token?: string) {\n  const api = axios.create({\n    baseURL: \"https://catalogsapi.vercel.app/v1\",\n  });\n\n  api.interceptors.request.use(\n    (config) => {\n      if (token) {\n        config.headers.Authorization = `Bearer ${token}`;\n      }\n      return config;\n    },\n\n    (error) => {\n      return Promise.reject(error);\n    }\n  );\n\n  return api;\n}\n"],"names":[],"mappings":"AAAA,aAAa;;;;AACb;;AAEO,SAAS,eAAe,KAAc;IAC3C,MAAM,MAAM,wIAAA,CAAA,UAAK,CAAC,MAAM,CAAC;QACvB,SAAS;IACX;IAEA,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG;8BAC1B,CAAC;YACC,IAAI,OAAO;gBACT,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;YAClD;YACA,OAAO;QACT;;8BAEA,CAAC;YACC,OAAO,QAAQ,MAAM,CAAC;QACxB;;IAGF,OAAO;AACT","debugId":null}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///home/jamille/Documentos/catalogs/provider/auth.tsx"],"sourcesContent":["\"use client\";\n\n// Next\nimport { useRouter } from \"next/navigation\";\n\n// Utils\nimport { setupApiClient } from \"@/utils/api/fetchData\";\n\n// Context\nimport { createContext, ReactNode, useEffect, useState } from \"react\";\n\n// Bibliotecas\nimport Cookies from \"js-cookie\";\n\n// Tipagem\nimport { itemUsers } from \"../types/users/index\";\n\n// Tipagens\ntype SignInProps = {\n  email: string;\n  password: string;\n};\n\ntype AuthContextData = {\n  user: itemUsers | undefined;\n  signIn: (credentials: SignInProps) => Promise<string>;\n  signOut: () => void;\n};\n\nexport const AuthContext = createContext({} as AuthContextData);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<itemUsers>();\n\n  const router = useRouter();\n  const api = setupApiClient();\n\n  async function signIn({ email, password }: SignInProps) {\n    try {\n      const resp = await api.post(\"/users/signin\", { email, password });\n\n      const user = resp.data.user;\n      const token = resp.data.token;\n\n      Cookies.set(\"auth_token\", token);\n      Cookies.set(\"user_rule\", user.rule.name);\n\n      setUser(user);\n      api.defaults.headers[\"Authorization\"] = `Bearer ${token}`;\n\n      const routeByRule: Record<string, string> = {\n        Admin: \"/dashboard\",\n        Dono: \"/dashboard\",\n        \"Suporte do Sistema\": \"/dashboard\",\n        cliente: \"/catalogo\",\n        Estoque: \"/estoque\",\n      };\n\n      router.push(routeByRule[user.rule.name]);\n    } catch (err: any) {\n      // Aviso de error\n\n      return err.response.data.message;\n    }\n  }\n\n  async function signOut() {\n    Cookies.remove(\"auth_token\");\n    setUser(undefined);\n    router.push(\"/signin\");\n  }\n\n  useEffect(() => {\n    const token = Cookies.get(\"auth_token\");\n    async function loadUser() {\n      if (token) {\n        try {\n          const api = setupApiClient(token);\n\n          const resp = await api.post(\"/users/me\");\n          setUser(resp.data.user);\n        } catch (err) {\n          console.log(\"Erro ao validar token:\", err);\n          signOut();\n        }\n      }\n    }\n\n    loadUser();\n  }, []);\n\n  return (\n    <AuthContext.Provider value={{ user, signIn, signOut }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA,OAAO;AACP;AAEA,QAAQ;AACR;AAEA,UAAU;AACV;AAEA,cAAc;AACd;;;AAZA;;;;;AA6BO,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD,EAAE,CAAC;AAEnC,SAAS,aAAa,EAAE,QAAQ,EAA2B;;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD;IAE/B,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,MAAM,CAAA,GAAA,4HAAA,CAAA,iBAAc,AAAD;IAEzB,eAAe,OAAO,EAAE,KAAK,EAAE,QAAQ,EAAe;QACpD,IAAI;YACF,MAAM,OAAO,MAAM,IAAI,IAAI,CAAC,iBAAiB;gBAAE;gBAAO;YAAS;YAE/D,MAAM,OAAO,KAAK,IAAI,CAAC,IAAI;YAC3B,MAAM,QAAQ,KAAK,IAAI,CAAC,KAAK;YAE7B,wJAAA,CAAA,UAAO,CAAC,GAAG,CAAC,cAAc;YAC1B,wJAAA,CAAA,UAAO,CAAC,GAAG,CAAC,aAAa,KAAK,IAAI,CAAC,IAAI;YAEvC,QAAQ;YACR,IAAI,QAAQ,CAAC,OAAO,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,OAAO;YAEzD,MAAM,cAAsC;gBAC1C,OAAO;gBACP,MAAM;gBACN,sBAAsB;gBACtB,SAAS;gBACT,SAAS;YACX;YAEA,OAAO,IAAI,CAAC,WAAW,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC;QACzC,EAAE,OAAO,KAAU;YACjB,iBAAiB;YAEjB,OAAO,IAAI,QAAQ,CAAC,IAAI,CAAC,OAAO;QAClC;IACF;IAEA,eAAe;QACb,wJAAA,CAAA,UAAO,CAAC,MAAM,CAAC;QACf,QAAQ;QACR,OAAO,IAAI,CAAC;IACd;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR,MAAM,QAAQ,wJAAA,CAAA,UAAO,CAAC,GAAG,CAAC;YAC1B,eAAe;gBACb,IAAI,OAAO;oBACT,IAAI;wBACF,MAAM,MAAM,CAAA,GAAA,4HAAA,CAAA,iBAAc,AAAD,EAAE;wBAE3B,MAAM,OAAO,MAAM,IAAI,IAAI,CAAC;wBAC5B,QAAQ,KAAK,IAAI,CAAC,IAAI;oBACxB,EAAE,OAAO,KAAK;wBACZ,QAAQ,GAAG,CAAC,0BAA0B;wBACtC;oBACF;gBACF;YACF;YAEA;QACF;iCAAG,EAAE;IAEL,qBACE,6LAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAQ;QAAQ;kBAClD;;;;;;AAGP;GAjEgB;;QAGC,qIAAA,CAAA,YAAS;;;KAHV","debugId":null}}]
}